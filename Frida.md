<div align='center'>

# **Frida**

</div>

## **1.  Set up Frida**

**Frida Client**

```zsh
python -m pip install frida-tools
```
![](./imgs/Frida/1.png)

![](./imgs/Frida/2.png)

**Frida Server**

Download the Frida server binary from [here](https://github.com/frida/frida/releases)

Extract the xz file to get the binary

Send the binary to the android emulator

![](./imgs/Frida/3.png)

Start the Frida server

![](./imgs/Frida/4.png)

Verify that the Frida server is running

![](./imgs/Frida/5.png)

## **2.  Frida Lab**

**Logcat output**

![](./imgs/Frida/6.png)

**Attempt 1**: Try to Brute force pin with this [hook script](./scripts/frida_lab/frida_labv1.py)

Get Timeout in Frida Server. 

![](./imgs/Frida/7.png)

Try with [setTimeout](./scripts/frida_lab/hook_scriptv2.js), It work but the brute force is too slow

**Attempt 2:** Use `resetCoolDown()`

Using IDA to reverse engineer the library using `resetCoolDown()` and `getKey()`, we can see that the `getKey()` function is implementing a brute force protection.

![](./imgs/Frida/8.png)

The `resetCoolDown()` function is used to reset the value of the counter in that brute force protection.    

![](./imgs/Frida/9.png)

Use [this hook script](./scripts/frida_lab/hook_scriptv3.js) to reset the counter and brute force the pin.

The program stop at 949461

![](./imgs/Frida/10.png)

Looking at the logcat output, we see global reference table overflow

![](./imgs/Frida/11.png)

So we need to run this script multiple times to get the pin

Finally, we use the `SecretBox()` class to find the correct pin: 918264

Script: [hook_scriptv4.js](./scripts/frida_lab/hook_scriptv4.js)

![](./imgs/Frida/12.png)

![](./imgs/Frida/13.png)