import frida
import time

def message_handler(message, data):
    print(message)
    print(data)

device = frida.get_usb_device() # get device information
print(device)
pid = device.spawn("com.hackerone.mobile.challenge2") # spawn app
device.resume(pid) # resumes it pid
time.sleep(1) # sleep 1 to avoid crash (sometime)
session=device.attach(pid)

# nonce = "aabbccddeeffgghhaabbccdd".encode()

# key = getKey(str)
with open("hook_scriptv4.js") as f:
    hook_script = f.read()
    script = session.create_script(hook_script)
script.on("message", message_handler)
script.load()

input("Press Enter to continue...")
